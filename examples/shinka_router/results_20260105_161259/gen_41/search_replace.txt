<NAME>
difficulty_routing_improvement
</NAME>

<DESCRIPTION>
This modification enhances the routing logic by utilizing the `classify_problem_type` method to further refine the approach based on the type of problem. By combining the difficulty estimation with the problem type classification, we can direct the agent to more appropriate solving strategies, especially for medium and hard problems. This should improve accuracy by ensuring that the right primitives are employed based on both the difficulty and the nature of the problem.
</DESCRIPTION>

<DIFF>
<<<<<<< SEARCH
        # Baseline: Exact match to adas_aime (temp=0.0, simple prompt)
        response, cost = self.baseline_solve(problem)
=======
        # Estimate difficulty and classify problem type
        difficulty, _ = self.estimate_difficulty(problem)
        problem_type, _ = self.classify_problem_type(problem)

        # Routing based on difficulty and type
        if difficulty == 'easy':
            response, cost = self.quick_solve(problem)
        elif difficulty == 'medium':
            if problem_type in ['algebra', 'geometry']:
                response, cost = self.deep_think(problem)
            else:
                response, cost = self.ensemble_vote(problem)
        else:  # hard problems
            response, cost = self.deep_think(problem)
            answer = self.extract_boxed_answer(response)
            if answer:
                verify_response, verify_cost = self.verify(problem, answer)
                response = verify_response
                cost += verify_cost
>>>>>>> REPLACE
</DIFF>